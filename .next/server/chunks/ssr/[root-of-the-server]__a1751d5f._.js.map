{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/constants.ts"],"sourcesContent":["import { Locale } from './models/locale.models';\n\nexport const LOCALE_COOKIE_NAME = 'NEXT_LOCALE';\nexport const SIGNUP_MODE_COOKIE_NAME = 'mode';\nexport const DEFAULT_LOCALE: Locale = 'en';\n\nexport const HOME_ROUTE = '/chat';\nexport const LOGIN_ROUTE = '/login';\n\nexport const SESSION_COOKIE_NAME = 'cbs_ses';\n\nexport const MIN_CATEGORIES_COUNT = 3;\nexport const MAX_CATEGORIES_COUNT = 10;\n\nexport const ACCEPTED_FILE_TYPES = {\n  'application/pdf': ['.pdf'],\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx', '.dotx', '.docm', '.dotm'],\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.template': ['.docx', '.dotx', '.docm', '.dotm'],\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx', '.xls'],\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation': [\n    '.pptx',\n    '.potx',\n    '.ppsx',\n    '.pptm',\n    '.potm',\n    '.ppsm',\n  ],\n  'application/json': ['.json'],\n  'application/xml': ['.xml'],\n  'text/markdown': ['.md'],\n  'text/x-markdown': ['.md'],\n  'text/plain': ['.txt'],\n  'text/x-asciidoc': ['.adoc'],\n  'text/html': ['.html', '.xhtml'],\n  'text/csv': ['.csv'],\n  'image/png': ['.png'],\n  'image/jpeg': ['.jpg', '.jpeg'],\n  'image/tiff': ['.tiff'],\n  'image/bmp': ['.bmp'],\n};\n\nexport enum PublicRoutes {\n  login = '/login',\n  signup = '/signup',\n  forgotPassword = '/forgot-password',\n  verification = '/verification',\n}\n\nexport enum PrivateRoutes {\n  chat = '/chat',\n  dashboard = '/dashboard',\n  checkout = '/checkout',\n  feedback = '/account/feedback',\n  stageInstructions = '/instructions/stages',\n  moderationInstructions = '/instructions/moderation',\n  instructions = '/instructions',\n  account = '/account',\n  content = '/content',\n  configuration = '/configuration',\n  coach = '/coach',\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEO,MAAM,qBAAqB;AAC3B,MAAM,0BAA0B;AAChC,MAAM,iBAAyB;AAE/B,MAAM,aAAa;AACnB,MAAM,cAAc;AAEpB,MAAM,sBAAsB;AAE5B,MAAM,uBAAuB;AAC7B,MAAM,uBAAuB;AAE7B,MAAM,sBAAsB;IACjC,mBAAmB;QAAC;KAAO;IAC3B,2EAA2E;QAAC;QAAS;QAAS;QAAS;KAAQ;IAC/G,2EAA2E;QAAC;QAAS;QAAS;QAAS;KAAQ;IAC/G,qEAAqE;QAAC;QAAS;KAAO;IACtF,6EAA6E;QAC3E;QACA;QACA;QACA;QACA;QACA;KACD;IACD,oBAAoB;QAAC;KAAQ;IAC7B,mBAAmB;QAAC;KAAO;IAC3B,iBAAiB;QAAC;KAAM;IACxB,mBAAmB;QAAC;KAAM;IAC1B,cAAc;QAAC;KAAO;IACtB,mBAAmB;QAAC;KAAQ;IAC5B,aAAa;QAAC;QAAS;KAAS;IAChC,YAAY;QAAC;KAAO;IACpB,aAAa;QAAC;KAAO;IACrB,cAAc;QAAC;QAAQ;KAAQ;IAC/B,cAAc;QAAC;KAAQ;IACvB,aAAa;QAAC;KAAO;AACvB;AAEO,IAAA,AAAK,sCAAA;;;;;WAAA;;AAOL,IAAA,AAAK,uCAAA;;;;;;;;;;;;WAAA","debugId":null}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/models/locale.models.ts"],"sourcesContent":["export type Locale = (typeof locales)[number];\n\n// use ISO 639-1 codes\nexport const locales = ['en', 'es', 'de', 'fr', 'it', 'uk', 'pl'] as const;\n\nexport enum Language {\n  en = 'English',\n  de = 'German',\n  fr = 'French',\n  it = 'Italian',\n  es = 'Spanish',\n  pl = 'Polish',\n  uk = 'Ukrainian',\n}\n"],"names":[],"mappings":";;;;AAGO,MAAM,UAAU;IAAC;IAAM;IAAM;IAAM;IAAM;IAAM;IAAM;CAAK;AAE1D,IAAA,AAAK,kCAAA;;;;;;;;WAAA","debugId":null}},
    {"offset": {"line": 151, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/encryption.utils.ts"],"sourcesContent":["import { JWTPayload, jwtVerify, SignJWT } from 'jose';\n\nimport 'server-only';\n\nexport async function encrypt<T extends JWTPayload>(\n  payload: T,\n  secretKey?: string,\n  expirationTime: string = '7d'\n): Promise<string | null> {\n  if (!payload || !secretKey) return null;\n\n  const encodedKey = new TextEncoder().encode(secretKey);\n\n  return new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime(expirationTime)\n    .sign(encodedKey);\n}\n\nexport async function decrypt<T>(encryptedData: string | undefined = '', secretKey?: string): Promise<T | null> {\n  try {\n    if (!encryptedData || !secretKey) return null;\n\n    const encodedKey = new TextEncoder().encode(secretKey);\n    const { payload } = await jwtVerify(encryptedData, encodedKey, { algorithms: ['HS256'] });\n\n    return payload as T;\n  } catch (error: any) {\n    console.error('[encryptionUtils] Failed to decrypt data:', error);\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAEA;;;AAEO,eAAe,QACpB,OAAU,EACV,SAAkB,EAClB,iBAAyB,IAAI;IAE7B,IAAI,CAAC,WAAW,CAAC,WAAW,OAAO;IAEnC,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC;IAE5C,OAAO,IAAI,qJAAA,CAAA,UAAO,CAAC,SAChB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,gBAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAW,gBAAoC,EAAE,EAAE,SAAkB;IACzF,IAAI;QACF,IAAI,CAAC,iBAAiB,CAAC,WAAW,OAAO;QAEzC,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC;QAC5C,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,uJAAA,CAAA,YAAS,AAAD,EAAE,eAAe,YAAY;YAAE,YAAY;gBAAC;aAAQ;QAAC;QAEvF,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,6CAA6C;QAC3D,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/cookie.utils.ts"],"sourcesContent":["import { cookies } from 'next/headers';\n\nimport { decrypt } from './encryption.utils';\n\nexport const getCookie = async <T>(name: string, encrypted?: boolean, secretKey?: string): Promise<T> => {\n  const cookieStore = await cookies();\n  const value = cookieStore.get(name)?.value;\n\n  return (value && encrypted ? decrypt<T>(value, secretKey) : value) as T;\n};\n\nexport const deleteCookie = async (name: string) => {\n  const cookieStore = await cookies();\n  cookieStore.delete(name);\n};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;AAEO,MAAM,YAAY,OAAU,MAAc,WAAqB;IACpE,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAChC,MAAM,QAAQ,YAAY,GAAG,CAAC,OAAO;IAErC,OAAQ,SAAS,YAAY,CAAA,GAAA,0IAAA,CAAA,UAAO,AAAD,EAAK,OAAO,aAAa;AAC9D;AAEO,MAAM,eAAe,OAAO;IACjC,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;IAChC,YAAY,MAAM,CAAC;AACrB","debugId":null}},
    {"offset": {"line": 211, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/locale.utils.ts"],"sourcesContent":["import { DEFAULT_LOCALE, LOCALE_COOKIE_NAME } from '../constants';\nimport { getCookie } from './cookie.utils';\n\nexport function normalizeLocale(locale: string): string {\n  if (locale.includes('-')) {\n    return locale.split('-')[0];\n  }\n\n  return locale;\n}\n\nexport async function getUserLocale() {\n  const lanaguage = (await getCookie<string>(LOCALE_COOKIE_NAME)) || DEFAULT_LOCALE;\n\n  return normalizeLocale(lanaguage);\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,gBAAgB,MAAc;IAC5C,IAAI,OAAO,QAAQ,CAAC,MAAM;QACxB,OAAO,OAAO,KAAK,CAAC,IAAI,CAAC,EAAE;IAC7B;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,MAAM,YAAY,AAAC,MAAM,CAAA,GAAA,sIAAA,CAAA,YAAS,AAAD,EAAU,uHAAA,CAAA,qBAAkB,KAAM,uHAAA,CAAA,iBAAc;IAEjF,OAAO,gBAAgB;AACzB","debugId":null}},
    {"offset": {"line": 235, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/i18n/request.ts"],"sourcesContent":["import { IntlErrorCode } from 'next-intl';\nimport { getRequestConfig } from 'next-intl/server';\n\nimport { DEFAULT_LOCALE } from '@/lib/constants';\nimport { Locale, locales } from '@/lib/models/locale.models';\nimport { getUserLocale } from '@/lib/utils/locale.utils';\n\nexport default getRequestConfig(async () => {\n  let locale = await getUserLocale();\n\n  if (!locales.includes(locale as Locale)) {\n    locale = DEFAULT_LOCALE;\n  }\n\n  return {\n    locale,\n    messages: (await import(`../../i18n_messages/${locale}.json`)).default,\n    onError(error) {\n      console.error('[i18nConfig] Error during setup iternationalization config: ', error);\n    },\n    getMessageFallback({ namespace, key, error }) {\n      const path = [namespace, key].filter((part) => part != null).join('.');\n\n      if (error.code === IntlErrorCode.MISSING_MESSAGE) {\n        return path + ' is not yet translated';\n      } else {\n        return '[i18nConfig] fix this message: ' + path;\n      }\n    },\n  };\n});\n"],"names":[],"mappings":";;;AAAA;AACA;AAEA;AACA;AACA;;;;;;uCAEe,CAAA,GAAA,0PAAA,CAAA,mBAAgB,AAAD,EAAE;IAC9B,IAAI,SAAS,MAAM,CAAA,GAAA,sIAAA,CAAA,gBAAa,AAAD;IAE/B,IAAI,CAAC,wIAAA,CAAA,UAAO,CAAC,QAAQ,CAAC,SAAmB;QACvC,SAAS,uHAAA,CAAA,iBAAc;IACzB;IAEA,OAAO;QACL;QACA,UAAU,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;kBAAa,CAAC,oBAAoB,EAAE,OAAO,KAAK,CAAC,CAAC,EAAE,OAAO;QACtE,SAAQ,KAAK;YACX,QAAQ,KAAK,CAAC,gEAAgE;QAChF;QACA,oBAAmB,EAAE,SAAS,EAAE,GAAG,EAAE,KAAK,EAAE;YAC1C,MAAM,OAAO;gBAAC;gBAAW;aAAI,CAAC,MAAM,CAAC,CAAC,OAAS,QAAQ,MAAM,IAAI,CAAC;YAElE,IAAI,MAAM,IAAI,KAAK,+NAAA,CAAA,gBAAa,CAAC,eAAe,EAAE;gBAChD,OAAO,OAAO;YAChB,OAAO;gBACL,OAAO,oCAAoC;YAC7C;QACF;IACF;AACF","debugId":null}},
    {"offset": {"line": 307, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/contexts/AccessProvider.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AccessProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AccessProvider() from the server but AccessProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/AccessProvider.tsx <module evaluation>\",\n    \"AccessProvider\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,iBAAiB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,iEACA","debugId":null}},
    {"offset": {"line": 321, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/contexts/AccessProvider.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AccessProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call AccessProvider() from the server but AccessProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/AccessProvider.tsx\",\n    \"AccessProvider\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,iBAAiB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAChD;IAAa,MAAM,IAAI,MAAM;AAA4O,GACzQ,6CACA","debugId":null}},
    {"offset": {"line": 335, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 345, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/contexts/ThemeContext.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const THEME_ID = registerClientReference(\n    function() { throw new Error(\"Attempted to call THEME_ID() from the server but THEME_ID is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx <module evaluation>\",\n    \"THEME_ID\",\n);\nexport const Theme = registerClientReference(\n    function() { throw new Error(\"Attempted to call Theme() from the server but Theme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx <module evaluation>\",\n    \"Theme\",\n);\nexport const ThemeProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx <module evaluation>\",\n    \"ThemeProvider\",\n);\nexport const useTheme = registerClientReference(\n    function() { throw new Error(\"Attempted to call useTheme() from the server but useTheme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx <module evaluation>\",\n    \"useTheme\",\n);\n"],"names":[],"mappings":";;;;;;AAAA;;AACO,MAAM,WAAW,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC1C;IAAa,MAAM,IAAI,MAAM;AAAgO,GAC7P,+DACA;AAEG,MAAM,QAAQ,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACvC;IAAa,MAAM,IAAI,MAAM;AAA0N,GACvP,+DACA;AAEG,MAAM,gBAAgB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,+DACA;AAEG,MAAM,WAAW,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC1C;IAAa,MAAM,IAAI,MAAM;AAAgO,GAC7P,+DACA","debugId":null}},
    {"offset": {"line": 371, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/contexts/ThemeContext.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const THEME_ID = registerClientReference(\n    function() { throw new Error(\"Attempted to call THEME_ID() from the server but THEME_ID is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx\",\n    \"THEME_ID\",\n);\nexport const Theme = registerClientReference(\n    function() { throw new Error(\"Attempted to call Theme() from the server but Theme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx\",\n    \"Theme\",\n);\nexport const ThemeProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call ThemeProvider() from the server but ThemeProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx\",\n    \"ThemeProvider\",\n);\nexport const useTheme = registerClientReference(\n    function() { throw new Error(\"Attempted to call useTheme() from the server but useTheme is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/contexts/ThemeContext.tsx\",\n    \"useTheme\",\n);\n"],"names":[],"mappings":";;;;;;AAAA;;AACO,MAAM,WAAW,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC1C;IAAa,MAAM,IAAI,MAAM;AAAgO,GAC7P,2CACA;AAEG,MAAM,QAAQ,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACvC;IAAa,MAAM,IAAI,MAAM;AAA0N,GACvP,2CACA;AAEG,MAAM,gBAAgB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC/C;IAAa,MAAM,IAAI,MAAM;AAA0O,GACvQ,2CACA;AAEG,MAAM,WAAW,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC1C;IAAa,MAAM,IAAI,MAAM;AAAgO,GAC7P,2CACA","debugId":null}},
    {"offset": {"line": 397, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 407, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/config.ts"],"sourcesContent":["export const firebaseConfig = {\n  apiKey: process.env.FIREBASE_API_KEY,\n  authDomain: process.env.FIREBASE_AUTH_DOMAIN,\n  projectId: process.env.FIREBASE_PROJECT_ID,\n  storageBucket: process.env.FIREBASE_STORAGE_BUCKET,\n  messagingSenderId: process.env.FIREBASE_MESSAGING_SENDER_ID,\n  appId: process.env.FIREBASE_APP_ID,\n  measurementId: process.env.FIREBASE_MEASUREMENT_ID,\n};\n"],"names":[],"mappings":";;;AAAO,MAAM,iBAAiB;IAC5B,QAAQ,QAAQ,GAAG,CAAC,gBAAgB;IACpC,YAAY,QAAQ,GAAG,CAAC,oBAAoB;IAC5C,WAAW,QAAQ,GAAG,CAAC,mBAAmB;IAC1C,eAAe,QAAQ,GAAG,CAAC,uBAAuB;IAClD,mBAAmB,QAAQ,GAAG,CAAC,4BAA4B;IAC3D,OAAO,QAAQ,GAAG,CAAC,eAAe;IAClC,eAAe,QAAQ,GAAG,CAAC,uBAAuB;AACpD","debugId":null}},
    {"offset": {"line": 425, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/firebase.ts"],"sourcesContent":["import { initializeApp } from 'firebase/app';\nimport { deleteUser, EmailAuthProvider, getAuth, onAuthStateChanged, signInWithCredential } from 'firebase/auth';\n\nimport { firebaseConfig } from './config';\n\nconst app = initializeApp(firebaseConfig);\nexport const auth = getAuth(app);\n\nonAuthStateChanged(auth, (user) => {\n  if (user) {\n    auth.updateCurrentUser(user);\n  }\n});\n\nasync function refetchAndDelete(email: string, password: string): Promise<void> {\n  try {\n    const credential = EmailAuthProvider.credential(email, password);\n    const userCredentials = await signInWithCredential(auth, credential);\n    await deleteUser(userCredentials.user);\n  } catch (signInError) {\n    console.error('Error signing in to delete user:', signInError);\n    throw signInError;\n  }\n}\n\nexport async function deleteFirebaseUser(email: string, password: string): Promise<void> {\n  try {\n    const user = auth.currentUser;\n\n    if (!user) {\n      await refetchAndDelete(email, password);\n    } else {\n      await deleteUser(user);\n      console.log('User deleted successfully');\n    }\n  } catch (error) {\n    console.error('Error deleting user:', error);\n    throw error;\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;;;;AAEA,MAAM,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE,oHAAA,CAAA,iBAAc;AACjC,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AAE5B,CAAA,GAAA,wNAAA,CAAA,qBAAkB,AAAD,EAAE,MAAM,CAAC;IACxB,IAAI,MAAM;QACR,KAAK,iBAAiB,CAAC;IACzB;AACF;AAEA,eAAe,iBAAiB,KAAa,EAAE,QAAgB;IAC7D,IAAI;QACF,MAAM,aAAa,uNAAA,CAAA,oBAAiB,CAAC,UAAU,CAAC,OAAO;QACvD,MAAM,kBAAkB,MAAM,CAAA,GAAA,2NAAA,CAAA,uBAAoB,AAAD,EAAE,MAAM;QACzD,MAAM,CAAA,GAAA,gNAAA,CAAA,aAAU,AAAD,EAAE,gBAAgB,IAAI;IACvC,EAAE,OAAO,aAAa;QACpB,QAAQ,KAAK,CAAC,oCAAoC;QAClD,MAAM;IACR;AACF;AAEO,eAAe,mBAAmB,KAAa,EAAE,QAAgB;IACtE,IAAI;QACF,MAAM,OAAO,KAAK,WAAW;QAE7B,IAAI,CAAC,MAAM;YACT,MAAM,iBAAiB,OAAO;QAChC,OAAO;YACL,MAAM,CAAA,GAAA,gNAAA,CAAA,aAAU,AAAD,EAAE;YACjB,QAAQ,GAAG,CAAC;QACd;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,wBAAwB;QACtC,MAAM;IACR;AACF","debugId":null}},
    {"offset": {"line": 478, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/models/checkout.models.ts"],"sourcesContent":["import { User } from './common.models';\n\nexport interface PriceCurrencyOption {\n  custom_unit_amount?: number | null;\n  tax_behavior: string;\n  unit_amount: number;\n  unit_amount_decimal: string;\n}\n\nexport interface Price {\n  id: string;\n  amount: number;\n  currency: string;\n  product: any;\n  interval: string;\n  name: string;\n  description: string;\n  marketing_features: { name: string }[];\n  isActive: boolean;\n  currency_options: Record<string, PriceCurrencyOption>;\n}\n\nexport enum PriceInterval {\n  Month = 'month',\n  Year = 'year',\n}\n\nexport enum SubscriptionStatus {\n  active = 'active',\n  trialing = 'trialing',\n  canceled = 'canceled',\n  paused = 'paused',\n  unpaid = 'unpaid',\n  past_due = 'past_due',\n  incomplete = 'incomplete',\n  incomplete_expired = 'incomplete_expired',\n}\n\nexport interface Subscription {\n  id: string;\n  subscriptionId: string | null;\n  customerId: string;\n  name: string | null;\n  status: SubscriptionStatus | string;\n  canceledAt: Date | null;\n  coaches: string | null;\n  analytics: string | null;\n  allowedIntegration: boolean | null;\n  trialDays: string | null;\n  trialUsed?: boolean | null;\n  userId: string;\n  user?: User;\n}\n\nexport enum PriceCurrency {\n  usd = 'usd',\n  eur = 'eur',\n  gbp = 'gbp',\n  aud = 'aud',\n  cad = 'cad',\n}\n"],"names":[],"mappings":";;;;;AAsBO,IAAA,AAAK,uCAAA;;;WAAA;;AAKL,IAAA,AAAK,4CAAA;;;;;;;;;WAAA;;AA2BL,IAAA,AAAK,uCAAA;;;;;;WAAA","debugId":null}},
    {"offset": {"line": 513, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/common.utils.ts"],"sourcesContent":["import { LOGIN_ROUTE, PrivateRoutes, PublicRoutes } from '../constants';\nimport { Assistant } from '../models/assistant.models';\nimport { Subscription, SubscriptionStatus } from '../models/checkout.models';\nimport { User } from '../models/common.models';\n\nexport const withoutTrailingSlash = (url: string = ''): string => {\n  return url.endsWith('/') ? url.slice(0, -1) : url;\n};\n\nexport const getRedirectPath = (\n  path: string,\n  userId?: string,\n  accessAllowed?: boolean,\n  search?: string\n): string | null => {\n  const publicRoutes: string[] = Object.values(PublicRoutes);\n  const isPublicRoute = publicRoutes.includes(path);\n  let redirectTo: string | null = null;\n\n  if (!isPublicRoute && !userId) {\n    redirectTo = `${LOGIN_ROUTE}${search}`;\n  } else if (isPublicRoute && userId) {\n    redirectTo = PrivateRoutes.chat;\n  } else if (userId && !accessAllowed && path !== PrivateRoutes.checkout) {\n    redirectTo = `${PrivateRoutes.checkout}${search}`;\n  }\n\n  return redirectTo;\n};\n\nexport const isActiveSubscription = (subscription?: Subscription | null, currentPriceId?: string) => {\n  if (!subscription || !subscription?.subscriptionId) return false;\n\n  const isActiveStatus = [SubscriptionStatus.active, SubscriptionStatus.trialing].includes(\n    subscription.status as SubscriptionStatus\n  );\n  const isFreePlan =\n    currentPriceId && process.env.STRIPE_FREE_PRICE && currentPriceId === process.env.STRIPE_FREE_PRICE;\n  const isFreePriceTrialEnded =\n    isFreePlan && !!subscription.canceledAt && new Date(subscription.canceledAt) < new Date();\n\n  return isActiveStatus && !isFreePriceTrialEnded;\n};\n\nexport const isTrialSubscription = ({ plan, trial_start, trial_end }: any, freePriceId?: string) => {\n  return (!freePriceId || plan.id !== freePriceId) && trial_start !== null && trial_end !== null;\n};\n\nexport const getIsAllowedUser = (userId?: string) => {\n  return !!userId && !!process.env.ALLOWED_USER_IDS && !!process.env.ALLOWED_USER_IDS.split(',').includes(userId);\n};\n\nexport const isAssistantCreationAllowed = (user: User | null, assistants: Assistant[]) => {\n  // TODO: Check if user is allowed to create assistants based on their subscription\n  if (user?.accessAllowed) return true;\n  if (!user?.subscription?.coaches) return false;\n\n  const allowedAssistants = Number(user.subscription?.coaches);\n\n  return isNaN(allowedAssistants) ? true : assistants.length < allowedAssistants;\n};\n\nexport const isLowerEnv = (envUrl: string) => ['stage', 'localhost'].some((env) => envUrl.includes(env));\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;AAGO,MAAM,uBAAuB,CAAC,MAAc,EAAE;IACnD,OAAO,IAAI,QAAQ,CAAC,OAAO,IAAI,KAAK,CAAC,GAAG,CAAC,KAAK;AAChD;AAEO,MAAM,kBAAkB,CAC7B,MACA,QACA,eACA;IAEA,MAAM,eAAyB,OAAO,MAAM,CAAC,uHAAA,CAAA,eAAY;IACzD,MAAM,gBAAgB,aAAa,QAAQ,CAAC;IAC5C,IAAI,aAA4B;IAEhC,IAAI,CAAC,iBAAiB,CAAC,QAAQ;QAC7B,aAAa,GAAG,uHAAA,CAAA,cAAW,GAAG,QAAQ;IACxC,OAAO,IAAI,iBAAiB,QAAQ;QAClC,aAAa,uHAAA,CAAA,gBAAa,CAAC,IAAI;IACjC,OAAO,IAAI,UAAU,CAAC,iBAAiB,SAAS,uHAAA,CAAA,gBAAa,CAAC,QAAQ,EAAE;QACtE,aAAa,GAAG,uHAAA,CAAA,gBAAa,CAAC,QAAQ,GAAG,QAAQ;IACnD;IAEA,OAAO;AACT;AAEO,MAAM,uBAAuB,CAAC,cAAoC;IACvE,IAAI,CAAC,gBAAgB,CAAC,cAAc,gBAAgB,OAAO;IAE3D,MAAM,iBAAiB;QAAC,0IAAA,CAAA,qBAAkB,CAAC,MAAM;QAAE,0IAAA,CAAA,qBAAkB,CAAC,QAAQ;KAAC,CAAC,QAAQ,CACtF,aAAa,MAAM;IAErB,MAAM,aACJ,kBAAkB,QAAQ,GAAG,CAAC,iBAAiB,IAAI,mBAAmB,QAAQ,GAAG,CAAC,iBAAiB;IACrG,MAAM,wBACJ,cAAc,CAAC,CAAC,aAAa,UAAU,IAAI,IAAI,KAAK,aAAa,UAAU,IAAI,IAAI;IAErF,OAAO,kBAAkB,CAAC;AAC5B;AAEO,MAAM,sBAAsB,CAAC,EAAE,IAAI,EAAE,WAAW,EAAE,SAAS,EAAO,EAAE;IACzE,OAAO,CAAC,CAAC,eAAe,KAAK,EAAE,KAAK,WAAW,KAAK,gBAAgB,QAAQ,cAAc;AAC5F;AAEO,MAAM,mBAAmB,CAAC;IAC/B,OAAO,CAAC,CAAC,UAAU,CAAC,CAAC,QAAQ,GAAG,CAAC,gBAAgB,IAAI,CAAC,CAAC,QAAQ,GAAG,CAAC,gBAAgB,CAAC,KAAK,CAAC,KAAK,QAAQ,CAAC;AAC1G;AAEO,MAAM,6BAA6B,CAAC,MAAmB;IAC5D,kFAAkF;IAClF,IAAI,MAAM,eAAe,OAAO;IAChC,IAAI,CAAC,MAAM,cAAc,SAAS,OAAO;IAEzC,MAAM,oBAAoB,OAAO,KAAK,YAAY,EAAE;IAEpD,OAAO,MAAM,qBAAqB,OAAO,WAAW,MAAM,GAAG;AAC/D;AAEO,MAAM,aAAa,CAAC,SAAmB;QAAC;QAAS;KAAY,CAAC,IAAI,CAAC,CAAC,MAAQ,OAAO,QAAQ,CAAC","debugId":null}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/models/common.models.ts"],"sourcesContent":["import { Assistant } from './assistant.models';\nimport { Subscription } from './checkout.models';\nimport { ModerationRule, Stage, Style } from './instruction.models';\n\nexport interface ModelConfig {\n  id: number;\n  temperature: number;\n  top_p: number;\n  frequency_penalty: number;\n  presence_penalty: number;\n  created_at: Date | null;\n  assistantId?: string | null;\n}\n\nexport interface Template {\n  id: string;\n  name: string;\n  instructions: string | null;\n  onboarding: string | null;\n  onboardingAnalyzer: string | null;\n  modelConfigs?: ModelConfig[];\n  moderationRules?: ModerationRule[];\n  stages?: Stage[];\n  styles?: Style[];\n}\n\nexport enum Period {\n  allTime = 'all time',\n  last7Days = '7',\n  last30Days = '30',\n}\n\nexport enum FileStatus {\n  error = 'error',\n  processing = 'processing',\n  complete = 'complete',\n}\n\nexport enum FileType {\n  knowledge = 'knowledge',\n  reference = 'reference',\n}\n\nexport interface KnowledgeFile {\n  id: string;\n  name: string;\n  location: string | null;\n  status: FileStatus | string;\n  uploaded_at: Date;\n  user_id: string;\n  file?: any;\n  checked?: boolean;\n  fileType: FileType | string;\n}\n\nexport interface User {\n  id: string;\n  name: string | null;\n  email: string;\n  emailVerified: boolean | null;\n  accessAllowed?: boolean | null;\n  onboardingPassed?: boolean | null;\n  Chat?: any[];\n  assistants?: Assistant[];\n  KnowledgeFile?: KnowledgeFile[];\n  subscription?: Subscription;\n}\n\nexport enum Level {\n  low = 'low',\n  medium = 'medium',\n  high = 'high',\n}\n\nexport type UpdateResult = {\n  success: boolean;\n  error?: string;\n};\n\nexport interface State<T> {\n  value?: T | null;\n  error?: string | null;\n  errors?: { name: string | number; message: string }[];\n  successMessage?: string | null;\n}\n\nexport interface SessionDetails {\n  details?: SessionDetailsTab[];\n  context?: SessionDetailsTab[];\n  progress?: SessionDetailsTab[];\n}\n\nexport interface SessionDetailsTab {\n  name: string;\n  descriptions: ({ type: 'text'; value: string; title?: string } | { type: 'list'; value: string[]; title?: string })[];\n}\n"],"names":[],"mappings":";;;;;;AA0BO,IAAA,AAAK,gCAAA;;;;WAAA;;AAML,IAAA,AAAK,oCAAA;;;;WAAA;;AAML,IAAA,AAAK,kCAAA;;;WAAA;;AA8BL,IAAA,AAAK,+BAAA;;;;WAAA","debugId":null}},
    {"offset": {"line": 610, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/models/instruction.models.ts"],"sourcesContent":["export interface Stage {\n  id: string;\n  name: string;\n  user_id?: string | null;\n  instructions: string | null;\n  analyzer?: string | null;\n  order: number;\n  templateId?: string | null;\n  assistantId?: string | null;\n}\n\nexport interface Style {\n  id: number;\n  user_id: string;\n  tone: string;\n  emoji_frequency: string;\n  language_complexity: string;\n  greeting_templates: string;\n  response_patterns: string;\n  closing_templates: string;\n  created_at: Date | null;\n  title: string | null;\n  custom: boolean | null;\n}\n\nexport interface ModerationTemplate {\n  id: string;\n  category: string;\n  response_template: string;\n  created_at: Date | null;\n  updated_at: Date | null;\n  rule_id: string | null;\n}\n\nexport interface Instruction {\n  purpose: string;\n  triggers: string;\n  when_to_use: string;\n  what_to_detect: string;\n}\n\nexport interface ModerationRule {\n  id: string;\n  user_id?: string | null;\n  name: string;\n  severity?: string | null;\n  instructions: Instruction | null;\n  created_at?: Date | string | null;\n  updated_at: Date | string | null;\n  custom: boolean | null;\n  response_template?: string;\n  ModerationTemplate?: ModerationTemplate[];\n}\n\nexport enum Severity {\n  low = 'low',\n  medium = 'medium',\n  high = 'high',\n}\n\nexport enum Tone {\n  friendly = 'friendly',\n  supportive = 'supportive',\n  professional = 'professional',\n  energetic = 'energetic',\n}\n"],"names":[],"mappings":";;;;AAsDO,IAAA,AAAK,kCAAA;;;;WAAA;;AAML,IAAA,AAAK,8BAAA;;;;;WAAA","debugId":null}},
    {"offset": {"line": 633, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/db.utils.ts"],"sourcesContent":["import {\n  ModerationTemplate,\n  ModelConfig as PrismaModelConfig,\n  ModerationRule as PrismaModerationRule,\n  Style as PrismaStyle,\n} from '@prisma/client';\nimport { JsonValue } from '@prisma/client/runtime/library';\nimport { z } from 'zod';\n\nimport { Message } from '../models/chat.models';\nimport { PriceCurrency } from '../models/checkout.models';\nimport { Level, ModelConfig } from '../models/common.models';\nimport { Instruction, ModerationRule, Severity, Style, Tone } from '../models/instruction.models';\n\nexport const defaultStyleData = {\n  title: '',\n  tone: Tone.friendly,\n  emoji_frequency: Level.low,\n  language_complexity: Level.low,\n  greeting_templates: '',\n  response_patterns: '',\n  closing_templates: '',\n  custom: true,\n  assistantId: '',\n};\n\nexport const defaultModerationRule = {\n  name: '',\n  severity: Severity.low,\n  instructions: { purpose: '', triggers: '', what_to_detect: '', when_to_use: '' },\n  custom: true,\n  assistantId: '',\n};\n\nconst levelEnum = z.enum([Level.low, Level.medium, Level.high]);\nconst toneEnum = z.enum([Tone.professional, Tone.energetic, Tone.friendly, Tone.supportive]);\nconst severityEnum = z.enum([Severity.high, Severity.low, Severity.medium]);\n\nexport const instructionSchema = z.object({\n  instructions: z\n    .string()\n    .min(10, { message: 'General.errors.minLength10' })\n    .max(10000, { message: 'General.errors.maxLength10000' }),\n});\n\nexport const stageSchema = z.object({\n  instructions: z\n    .string()\n    .min(10, { message: 'General.errors.minLength10' })\n    .max(10000, { message: 'General.errors.maxLength10000' }),\n  analyzer: z\n    .string()\n    .min(10, { message: 'General.errors.minLength10' })\n    .max(10000, { message: 'General.errors.maxLength10000' })\n    .optional(),\n});\n\nexport const orderSchema = z.object({ order: z.number().min(0, { message: 'General.errors.emptyFiled' }) });\nexport const nameSchema = z.object({ name: z.string().min(1, { message: 'General.errors.emptyFiled' }) });\nexport const categorySchema = z.object({ category: z.string().min(1, { message: 'General.errors.emptyFiled' }) });\n\nexport const userAccountSchema = z.object({\n  name: z.string().min(1, { message: 'Account.accountForm.errors.emptyName' }),\n  email: z\n    .string()\n    .min(1, { message: 'Account.accountForm.errors.emptyEmail' })\n    .email({ message: 'Account.accountForm.errors.invalidEmail' }),\n});\n\nexport const styleSchema = z.object({\n  emoji_frequency: levelEnum,\n  language_complexity: levelEnum,\n  tone: toneEnum,\n  greeting_templates: z\n    .string()\n    .min(50, { message: 'General.errors.minLength50' })\n    .max(10000, { message: 'General.errors.maxLength10000' }),\n  response_patterns: z\n    .string()\n    .min(50, { message: 'General.errors.minLength50' })\n    .max(10000, { message: 'General.errors.maxLength10000' }),\n  closing_templates: z\n    .string()\n    .min(50, { message: 'General.errors.minLength50' })\n    .max(10000, { message: 'General.errors.maxLength10000' }),\n});\n\nexport const moderationTemplateSchema = z.object({\n  id: z.string().min(1, { message: 'General.errors.emptyFiled' }),\n  category: z.string().min(1, { message: 'General.errors.emptyFiled' }),\n  response_template: z.string().optional(),\n});\n\nexport const moderationRuleSchema = z.object({\n  name: z.string().min(3, { message: 'General.errors.emptyFiled' }),\n  severity: severityEnum,\n  instructions: z.object({\n    purpose: z.string().min(3, { message: 'General.errors.emptyFiled' }),\n    triggers: z\n      .string()\n      .transform((val) =>\n        val\n          .split(',')\n          .map((s) => s.trim())\n          .filter((s) => s !== '')\n      )\n      .refine((val) => val.length > 0, {\n        message: 'General.errors.emptyFiled',\n      }),\n    when_to_use: z.string().min(5, { message: 'General.errors.emptyFiled' }),\n    what_to_detect: z.string().min(5, { message: 'General.errors.emptyFiled' }),\n  }),\n  response_template: z\n    .string()\n    .min(50, { message: 'General.errors.minLength50' })\n    .max(10000, { message: 'General.errors.maxLength10000' })\n    .optional(),\n  ModerationTemplate: z.array(moderationTemplateSchema).optional(),\n});\n\nexport const assistantSchema = z.object({\n  template: z.object({}).refine((val) => val !== null && val !== undefined, {\n    message: 'General.errors.templateSelection',\n  }),\n  name: z\n    .string()\n    .min(1, { message: 'General.errors.emptyFiled' })\n    .max(200, { message: 'General.errors.maxLength200' }),\n  description: z\n    .string()\n    .min(1, { message: 'General.errors.emptyFiled' })\n    .max(2000, { message: 'General.errors.maxLength2000' }),\n});\n\nexport const assistantPriceSchema = z.object({\n  currency: z.enum(Object.values(PriceCurrency) as [string, ...string[]]),\n  monthly: z.coerce.number().min(1, { message: 'General.errors.emptyFiled' }),\n  yearly: z.coerce.number().optional(),\n  trialDays: z.string().optional(),\n});\n\nexport function getRandomInt(min: number, max: number): number {\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nexport function generateUniqueIds(count: number, min: number, max: number): number[] {\n  const ids = new Set<number>();\n  while (ids.size < count) {\n    ids.add(getRandomInt(min, max));\n  }\n  return Array.from(ids);\n}\n\nexport function mapConversationHistory(\n  messages: Message[],\n  stage_name: string,\n  current_stage: boolean\n): { content: string; role: string }[] {\n  return messages\n    .filter(({ stage }: Message) => (current_stage ? stage_name === stage : stage_name !== stage))\n    .map(({ content, role }: Message) => ({ content, role }));\n}\n\nexport function parseJsonField<T>(field: T | string | JsonValue | JSON): T {\n  if (typeof field === 'string') {\n    try {\n      return (field.length > 0 ? JSON.parse(field) : field) as T;\n    } catch (error) {\n      console.error('Failed to parse field:', error);\n      return field as T;\n    }\n  }\n\n  return field as T;\n}\n\nexport function parseArrayToString<T>(data: T, keys: string[]): Partial<T> {\n  return keys.reduce((finalData: Partial<T>, key: string) => {\n    const parsedField = parseJsonField<T[keyof T]>(data[key as keyof T]);\n\n    return {\n      ...finalData,\n      [key]: Array.isArray(parsedField) ? parsedField.join('\\n') : parsedField,\n    };\n  }, {});\n}\n\nexport const mapStyleData = (style: PrismaStyle | Style): Style => {\n  return {\n    ...style,\n    ...parseArrayToString(style, ['greeting_templates', 'response_patterns', 'closing_templates']),\n  } as any;\n};\n\nexport const mapPrismaModerationData = (\n  rule: PrismaModerationRule,\n  selectedTemplates: ModerationTemplate[] = []\n): ModerationRule => {\n  const parserInstructions = parseJsonField<Instruction>(rule.instructions);\n  const response_template = selectedTemplates.length ? selectedTemplates.reverse()[0]?.response_template : '';\n\n  return {\n    ...rule,\n    instructions: {\n      ...parserInstructions,\n      triggers: Array.isArray(parserInstructions.triggers)\n        ? parserInstructions.triggers.join(', ')\n        : parserInstructions.triggers,\n    },\n    response_template,\n  };\n};\n\nexport const mapModerationRule = (\n  rule: ModerationRule,\n  selectedTemplates: ModerationTemplate[] = []\n): ModerationRule => {\n  let ModerationTemplate = rule.ModerationTemplate;\n\n  if (ModerationTemplate?.length) {\n    ModerationTemplate = ModerationTemplate.filter(({ id }) =>\n      selectedTemplates.some((template) => template.id === id)\n    ).map((template) => ({ ...template, response_template: rule.response_template || '' }));\n  }\n\n  return {\n    ...rule,\n    ModerationTemplate,\n  };\n};\n\nexport const mapPrismaModelConfig = (config: PrismaModelConfig): ModelConfig => {\n  return {\n    ...config,\n    temperature: config.temperature?.toNumber(),\n    presence_penalty: config.presence_penalty?.toNumber(),\n    frequency_penalty: config.frequency_penalty?.toNumber(),\n    top_p: config.top_p?.toNumber(),\n  };\n};\n\nexport const mapRelationConfig = <T>(data: T & { modelConfigs: PrismaModelConfig[] }): T => {\n  return {\n    ...data,\n    modelConfigs: data.modelConfigs.length ? data.modelConfigs.map(mapPrismaModelConfig) : [],\n  };\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 968, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/server/db/stripeClient.ts"],"sourcesContent":["import Stripe from 'stripe';\n\nimport { PrivateRoutes } from '@/lib/constants';\nimport { Subscription, SubscriptionStatus } from '@/lib/models/checkout.models';\nimport { User } from '@/lib/models/common.models';\nimport { isActiveSubscription, isTrialSubscription, withoutTrailingSlash } from '@/lib/utils/common.utils';\n\nclass StripeClient {\n  private static instance: StripeClient;\n  private _stripe: Stripe | null = null;\n\n  private constructor() {}\n\n  public static getInstance(): StripeClient {\n    if (!StripeClient.instance) {\n      StripeClient.instance = new StripeClient();\n    }\n    return StripeClient.instance;\n  }\n\n  private get stripe(): Stripe {\n    if (!this._stripe) {\n      if (!process.env.STRIPE_SECRET_KEY) {\n        throw new Error('STRIPE_SECRET_KEY is missing in environment variables.');\n      }\n\n      this._stripe = new Stripe(process.env.STRIPE_SECRET_KEY, {\n        apiVersion: '2025-05-28.basil',\n        typescript: true,\n      });\n    }\n\n    return this._stripe;\n  }\n\n  public async getSubscriptionData(id?: string | null): Promise<Stripe.Subscription | null> {\n    try {\n      if (!id) return null;\n\n      const subscription = await this.stripe.subscriptions.retrieve(id, { expand: ['items.data.price.product'] });\n\n      return subscription;\n    } catch (error) {\n      console.error(`[stripeClient] Error getting subscription ${id} data:`, error);\n      return null;\n    }\n  }\n\n  public async getAllPrices(): Promise<{ data: Stripe.Price[] }> {\n    try {\n      return this.stripe.prices.list({ active: true, expand: ['data.product', 'data.currency_options'], limit: 100 });\n    } catch (error) {\n      console.error(`[stripeClient] Error getting price list:`, error);\n      return { data: [] };\n    }\n  }\n\n  public async getCustomerByEmail(email: string) {\n    try {\n      return this.stripe.customers.search({ query: `email:'${email}'`, expand: ['data.subscriptions'] });\n    } catch (error) {\n      console.error(`[stripeClient] Error fetching customer by email ${email}:`, error);\n      throw new Error('Could not fetch customer by email');\n    }\n  }\n\n  public async getStripeCustomer(email: string, name?: string) {\n    try {\n      const { data } = await this.getCustomerByEmail(email);\n\n      return data[0] || (await this.stripe.customers.create({ email, name }));\n    } catch (error) {\n      console.error(`[stripeClient] Error creating customer for email ${email}:`, error);\n      throw new Error('Could not create customer');\n    }\n  }\n\n  public async getStripeActiveSubscriptionByEmail(email: string) {\n    try {\n      const allSubscriptions = await this.getAllStripeSubscriptionByEmail(email);\n\n      return allSubscriptions.find(({ status }) =>\n        [SubscriptionStatus.active, SubscriptionStatus.trialing].includes(status as any)\n      );\n    } catch (error) {\n      console.error(`[stripeClient] Error getting subscription by email ${email}:`, error);\n      throw new Error('Could not get customer subscription');\n    }\n  }\n\n  public async createSubscription(customer: string, price: string, trial_period_days?: number) {\n    try {\n      return this.stripe.subscriptions.create({\n        customer,\n        items: [{ price }],\n        trial_period_days,\n        trial_settings: {\n          end_behavior: {\n            missing_payment_method: 'cancel',\n          },\n        },\n      });\n    } catch (error: any) {\n      console.error(\n        `[stripeClient] Error during creating subscription with trial ${trial_period_days} for customer ${customer}:`,\n        error\n      );\n\n      throw new Error('[stripeClient] Could not create subscription with trial');\n    }\n  }\n\n  public async getSubscriptionProduct(subscription: any) {\n    try {\n      return this.stripe.products.retrieve(subscription.plan.product);\n    } catch (error) {\n      console.error(`[stripeClient] Error fetching product ${subscription.plan.product}:`, error);\n      throw new Error('Could not fetch subscription product');\n    }\n  }\n\n  public async getWebhook(payload: string | Buffer, header: string | Buffer | string[]) {\n    try {\n      if (!process.env.STRIPE_WEBHOOK_SECRET) throw new Error('STRIPE_WEBHOOK_SECRET is missing');\n\n      return this.stripe.webhooks.constructEvent(payload, header, process.env.STRIPE_WEBHOOK_SECRET);\n    } catch (error) {\n      console.error(`[stripeClient] Error in constructing webhook event:`, error);\n      throw new Error('Could not construct webhook event');\n    }\n  }\n\n  public async cancelSubscription(subscriptionId: string, comment?: string) {\n    try {\n      return await this.stripe.subscriptions.cancel(subscriptionId, {\n        cancellation_details: {\n          comment:\n            comment ||\n            `[studio webhook] Canceled subscription (${subscriptionId}) as it is no longer active due to a new purchase.`,\n        },\n      });\n    } catch (error) {\n      console.error(`[stripeClient] Error canceling subscription ${subscriptionId}:`, error);\n      return null;\n    }\n  }\n\n  public async deleteCustomer(userId?: string) {\n    try {\n      if (!userId) return;\n      return await this.stripe.customers.del(userId);\n    } catch (error) {\n      console.error(`[stripeClient] Error deleting customer ${userId}:`, error);\n      return null;\n    }\n  }\n\n  public async createCheckoutSession(\n    priceId: string,\n    currency: string = 'eur',\n    subscription?: Subscription,\n    trial_period_days?: number\n  ) {\n    try {\n      const metadata =\n        subscription && isActiveSubscription(subscription)\n          ? { current_active: subscription.subscriptionId }\n          : undefined;\n\n      return this.stripe.checkout.sessions.create({\n        currency: isActiveSubscription(subscription) ? undefined : currency,\n        customer: subscription?.customerId,\n        payment_method_types: ['card'],\n        mode: 'subscription',\n        line_items: [{ price: priceId, quantity: 1 }],\n        allow_promotion_codes: true,\n        success_url: `${withoutTrailingSlash(process.env.APP_BASE_URL)}${PrivateRoutes.chat}?success=true`,\n        cancel_url: `${withoutTrailingSlash(process.env.APP_BASE_URL)}${PrivateRoutes.checkout}`,\n        subscription_data: { metadata, trial_period_days },\n        automatic_tax: {\n          enabled: true,\n        },\n        tax_id_collection: {\n          enabled: true,\n        },\n        customer_update: subscription?.customerId\n          ? {\n              name: 'auto',\n              address: 'auto',\n            }\n          : undefined,\n        consent_collection: {\n          terms_of_service: 'required',\n        },\n        custom_text: {\n          terms_of_service_acceptance: {\n            message:\n              \"I agree to the Coachbot AI GmbH's [Terms of Service](https://www.coachbot.ai/legal/terms-of-service)\",\n          },\n        },\n      });\n    } catch (error) {\n      console.error(`[stripeClient] Error creating checkout session:`, error);\n      throw new Error('Failed to create checkout session');\n    }\n  }\n\n  public async checkTrialSubscriptions({ email }: User) {\n    const allSubscriptions = await this.getAllStripeSubscriptionByEmail(email);\n\n    return allSubscriptions.some((subscription) => isTrialSubscription(subscription, process.env.STRIPE_FREE_PRICE));\n  }\n\n  private async getAllStripeSubscriptionByEmail(email: string): Promise<Stripe.Subscription[]> {\n    try {\n      const { data } = await this.getCustomerByEmail(email);\n\n      if (!data?.length) return [];\n\n      const subscriptions = await this.stripe.subscriptions.list({\n        customer: data[0].id,\n        status: 'all',\n        limit: 100,\n      });\n\n      return subscriptions.data;\n    } catch (error) {\n      console.error(`[stripeClient] Error getting all subscription by email ${email}:`, error);\n      throw new Error('Could not get all customer subscriptions');\n    }\n  }\n}\n\nexport const stripeClient = StripeClient.getInstance();\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1220, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client';\nimport { withAccelerate } from '@prisma/extension-accelerate';\n\nconst globalForPrisma = global as unknown as { prisma?: PrismaClient };\n\nconst prisma = (globalForPrisma.prisma ?? new PrismaClient().$extends(withAccelerate())) as PrismaClient;\n\nif (process.env.NODE_ENV !== 'production') {\n  globalForPrisma.prisma = prisma;\n}\n\nexport default prisma;\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEA,MAAM,kBAAkB;AAExB,MAAM,SAAU,gBAAgB,MAAM,IAAI,IAAI,6HAAA,CAAA,eAAY,GAAG,QAAQ,CAAC,CAAA,GAAA,oKAAA,CAAA,iBAAc,AAAD;AAEnF,wCAA2C;IACzC,gBAAgB,MAAM,GAAG;AAC3B;uCAEe","debugId":null}},
    {"offset": {"line": 1239, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/server/db/userClient.ts"],"sourcesContent":["import { KnowledgeFile, Prisma, Subscription, User } from '@prisma/client';\n\nimport prisma from '@/lib/prisma';\n\nexport async function getUserData(id: string): Promise<(User & { subscription: Subscription | null }) | null> {\n  try {\n    return prisma.user.findUnique({ where: { id }, include: { subscription: true } });\n  } catch (error) {\n    console.error(`[userClient] Error fetching user ${id}:`, error);\n\n    return null;\n  }\n}\n\nexport async function createUser(newUserData: Partial<User>): Promise<User | null> {\n  try {\n    return await prisma.user.create({\n      data: {\n        ...newUserData,\n        id: newUserData.id!,\n      },\n    });\n  } catch (error) {\n    console.error(`[userClient] Error during creating user ${newUserData.id}:`, error);\n    return null;\n  }\n}\n\nexport async function updateUser(id: string, data: Partial<User>): Promise<User | null> {\n  try {\n    return prisma.user.update({ where: { id }, data });\n  } catch (error) {\n    console.error(`[userClient] Error during updating user ${id}:`, error);\n\n    return null;\n  }\n}\n\nexport async function upsertUser(\n  id: string,\n  data: Partial<User>\n): Promise<Prisma.UserGetPayload<{ include: { assistants: true; subscription: true } }> | null> {\n  try {\n    const user = await prisma.user.upsert({\n      where: { id },\n      update: { ...data },\n      create: {\n        ...data,\n        id,\n      },\n      include: {\n        assistants: {\n          orderBy: {\n            created_at: 'asc',\n          },\n        },\n        subscription: true,\n      },\n    });\n\n    return user;\n  } catch (error) {\n    console.error(`[userClient] Error during upsert user ${id}:`, error);\n\n    return null;\n  }\n}\n\nexport async function deleteUserData(id: string) {\n  try {\n    const user = await prisma.user.delete({ where: { id } });\n\n    return user;\n  } catch (error) {\n    console.error(`[userClient] Error during deleting user ${id}:`, error);\n\n    return null;\n  }\n}\n\nexport const getUserFiles = async (id: string): Promise<KnowledgeFile[]> => {\n  try {\n    const user = await prisma.user.findUnique({\n      where: { id },\n      include: {\n        KnowledgeFile: {\n          orderBy: {\n            uploaded_at: 'desc',\n          },\n        },\n      },\n    });\n\n    return user?.KnowledgeFile || [];\n  } catch (error) {\n    console.error(`[userClient] Error fetching user ${id}:`, error);\n\n    return [];\n  }\n};\n\nexport async function uploadUserFiles(\n  data: Pick<KnowledgeFile, 'id' | 'name' | 'status' | 'location' | 'user_id'>\n): Promise<KnowledgeFile | null> {\n  try {\n    return prisma.knowledgeFile.create({ data });\n  } catch (error) {\n    console.error(`[userClient] Error during uploading user files:`, error);\n\n    return null;\n  }\n}\n\nexport async function editUserFile(\n  user_id: string,\n  id: string,\n  data: Partial<KnowledgeFile>\n): Promise<KnowledgeFile | null> {\n  try {\n    return prisma.knowledgeFile.update({ where: { user_id, id }, data });\n  } catch (error) {\n    console.error(`[userClient] Error during editing user ${user_id} file ${id}:`, error);\n\n    return null;\n  }\n}\n\nexport async function deleteUserFile(user_id: string, id: string): Promise<KnowledgeFile | null> {\n  try {\n    return prisma.knowledgeFile.delete({ where: { user_id, id } });\n  } catch (error) {\n    console.error(`[userClient] Error during deleting user ${user_id} file ${id}:`, error);\n\n    return null;\n  }\n}\n\nexport async function getUserSubscription(customerId: string, subscriptionId?: string) {\n  try {\n    return prisma.subscription.findUnique({ where: { customerId, subscriptionId } });\n  } catch (error) {\n    console.error(`[userClient] Error get subscription for customer ${customerId}:`, error);\n\n    return null;\n  }\n}\n\nexport async function createUserSubscription(\n  userId: string,\n  data: Pick<Subscription, 'customerId' | 'status'>\n): Promise<Subscription | null> {\n  try {\n    return await prisma.subscription.create({ data: { ...data, userId } });\n  } catch (error) {\n    console.error(`[userClient] Error during creating user ${userId} subscription:`, error);\n\n    return null;\n  }\n}\n\nexport async function updateUserSubscription(\n  customerId: string,\n  data: Partial<Subscription>\n): Promise<Subscription | null> {\n  try {\n    return prisma.subscription.update({ where: { customerId }, data });\n  } catch (error) {\n    console.error(`[userClient] Error during updating customer ${customerId} subscription:`, error);\n\n    return null;\n  }\n}\n\nexport async function deleteUserSubscription(\n  customerId: string,\n  subscriptionId?: string\n): Promise<Subscription | null> {\n  try {\n    return prisma.subscription.delete({ where: { customerId, subscriptionId } });\n  } catch (error) {\n    console.error(`[userClient] Error during deleting customer ${customerId} subscription:`, error);\n\n    return null;\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1453, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/eventEmitter.ts"],"sourcesContent":["import { EventEmitter } from 'events';\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var _eventEmitter: EventEmitter | undefined;\n}\n\nconst eventEmitter = global._eventEmitter || new EventEmitter();\nglobal._eventEmitter = eventEmitter;\n\nexport default eventEmitter;\n"],"names":[],"mappings":";;;AAAA;;AAOA,MAAM,eAAe,OAAO,aAAa,IAAI,IAAI,qGAAA,CAAA,eAAY;AAC7D,OAAO,aAAa,GAAG;uCAER","debugId":null}},
    {"offset": {"line": 1467, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/data.utils.ts"],"sourcesContent":["export const deepEqual = (obj1: any, obj2: any): boolean => {\n  if (typeof obj1 !== 'object' || typeof obj2 !== 'object' || obj1 === null || obj2 === null) {\n    return obj1 === obj2;\n  }\n\n  const keys1 = Object.keys(obj1).sort();\n  const keys2 = Object.keys(obj2).sort();\n\n  if (keys1.length !== keys2.length) return false;\n\n  return keys1.every((key) => deepEqual(obj1[key], obj2[key]));\n};\n\nexport const mapFiles = (files: File[], status: string, message?: string) => {\n  return files.map((file: File, index: number) => ({\n    content: file,\n    id: `${Date.now()}-${file.name}-${index}`,\n    name: file.name,\n    status,\n    message,\n  }));\n};\n\nexport const toBoolean = (value: string | boolean | undefined | null): boolean => {\n  if (typeof value === 'boolean') return value;\n\n  return value ? value?.toLowerCase() === 'true' : false;\n};\n"],"names":[],"mappings":";;;;;AAAO,MAAM,YAAY,CAAC,MAAW;IACnC,IAAI,OAAO,SAAS,YAAY,OAAO,SAAS,YAAY,SAAS,QAAQ,SAAS,MAAM;QAC1F,OAAO,SAAS;IAClB;IAEA,MAAM,QAAQ,OAAO,IAAI,CAAC,MAAM,IAAI;IACpC,MAAM,QAAQ,OAAO,IAAI,CAAC,MAAM,IAAI;IAEpC,IAAI,MAAM,MAAM,KAAK,MAAM,MAAM,EAAE,OAAO;IAE1C,OAAO,MAAM,KAAK,CAAC,CAAC,MAAQ,UAAU,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI;AAC5D;AAEO,MAAM,WAAW,CAAC,OAAe,QAAgB;IACtD,OAAO,MAAM,GAAG,CAAC,CAAC,MAAY,QAAkB,CAAC;YAC/C,SAAS;YACT,IAAI,GAAG,KAAK,GAAG,GAAG,CAAC,EAAE,KAAK,IAAI,CAAC,CAAC,EAAE,OAAO;YACzC,MAAM,KAAK,IAAI;YACf;YACA;QACF,CAAC;AACH;AAEO,MAAM,YAAY,CAAC;IACxB,IAAI,OAAO,UAAU,WAAW,OAAO;IAEvC,OAAO,QAAQ,OAAO,kBAAkB,SAAS;AACnD","debugId":null}},
    {"offset": {"line": 1500, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/server/actions/checkoutActions.ts"],"sourcesContent":["'use server';\n\nimport Stripe from 'stripe';\n\nimport { PrivateRoutes } from '@/lib/constants';\nimport eventEmitter from '@/lib/eventEmitter';\nimport { Price, Subscription, SubscriptionStatus } from '@/lib/models/checkout.models';\nimport { User } from '@/lib/models/common.models';\nimport { isActiveSubscription, withoutTrailingSlash } from '@/lib/utils/common.utils';\nimport { toBoolean } from '@/lib/utils/data.utils';\nimport { stripeClient } from '../db/stripeClient';\nimport { createUserSubscription, deleteUserSubscription, updateUserSubscription } from '../db/userClient';\nimport { getUser } from './userActions';\n\nexport const mapStripePrices = async (\n  prices: Price[] = [],\n  activePrice: { id: string; productId: string; interval?: string } | null\n): Promise<Price[]> => {\n  return prices\n    .map((price: any) => {\n      const { id, name, active, description, metadata, marketing_features } = price.product;\n      const isStudioPrice = active && toBoolean(metadata.forStudio);\n      const isActive =\n        activePrice?.id === price.id ||\n        (activePrice?.productId === id && activePrice?.interval === price.recurring.interval);\n\n      return (\n        isStudioPrice && {\n          name,\n          id: price.id,\n          description,\n          amount: price.unit_amount / 100,\n          currency: price.currency,\n          product: price.product,\n          marketing_features,\n          interval: price.recurring.interval,\n          isActive,\n          currency_options: price.currency_options,\n        }\n      );\n    })\n    .filter(Boolean)\n    .sort((a, b) => Number(a.amount) - Number(b.amount));\n};\n\nexport const getUserCurrentPrice = async (\n  currentUser?: User\n): Promise<{ id: string; productId: string; interval?: string } | null> => {\n  try {\n    const user = currentUser || (await getUser());\n\n    if (!user) return null;\n\n    const subscription = isActiveSubscription(user.subscription)\n      ? await stripeClient.getSubscriptionData(user.subscription?.subscriptionId)\n      : null;\n\n    const { id = '', product = {} as any, recurring } = (subscription && subscription?.items?.data?.[0]?.price) ?? {};\n\n    return { id, productId: product?.id, interval: recurring?.interval };\n  } catch (error: any) {\n    console.error('[checkoutActions] Error during get user current price:', error);\n\n    return null;\n  }\n};\n\nexport const getPrices = async (): Promise<Price[]> => {\n  try {\n    const [{ data }, activePrice] = await Promise.all([stripeClient.getAllPrices(), getUserCurrentPrice()]);\n\n    return mapStripePrices(data as any, activePrice);\n  } catch (error: any) {\n    console.error('[checkoutActions] Error during fetching prices:', error);\n\n    return [];\n  }\n};\n\nexport const getUserCurrentSubscription = async ({\n  id,\n  subscription,\n  email,\n  name,\n}: User): Promise<Subscription | null> => {\n  try {\n    if (!!subscription?.customerId) return subscription;\n\n    const customer = await stripeClient.getStripeCustomer(email, name || '');\n\n    return await createUserSubscription(id, {\n      customerId: customer.id,\n      status: SubscriptionStatus.incomplete,\n    });\n  } catch (error: any) {\n    console.error('[checkoutActions] Error during get used saved subscription:', error);\n\n    return null;\n  }\n};\n\nexport const createUserCheckoutSession = async (price: Price, currency?: string): Promise<any> => {\n  let userId;\n  try {\n    const user = await getUser();\n\n    if (!user) return (await stripeClient.createCheckoutSession(price.id, currency))?.url;\n\n    userId = user.id;\n    const currentSubscription = await getUserCurrentSubscription(user);\n    const { trialUsed } = currentSubscription || {};\n    const withoutTrialPeriod = trialUsed != null ? trialUsed : await stripeClient.checkTrialSubscriptions(user);\n    const trialDays = withoutTrialPeriod ? undefined : Number(price.product.metadata?.trialDays) || 14;\n    const session =\n      currentSubscription &&\n      (await stripeClient.createCheckoutSession(price.id, currency, currentSubscription, trialDays));\n\n    return session?.url || '';\n  } catch (error: any) {\n    console.error(`[checkoutActions] Error during creating checkout session for user ${userId}:`, error);\n\n    throw new Error('[checkoutActions] Could not create session');\n  }\n};\n\nexport const createUserFreeSubscription = async (user: User, trialDays?: number): Promise<any> => {\n  try {\n    const { customerId } = (await getUserCurrentSubscription(user)) || {};\n\n    if (!customerId || !process.env.STRIPE_FREE_PRICE) return;\n\n    return await stripeClient.createSubscription(customerId, process.env.STRIPE_FREE_PRICE, trialDays);\n  } catch (error: any) {\n    console.error(`[checkoutActions] Error during creating trial subscription for user ${user.id}:`, error);\n\n    throw new Error('[checkoutActions] Could not create session');\n  }\n};\n\nexport const cancelUserSubscription = async (): Promise<any> => {\n  let userId, subscription;\n  try {\n    const user = await getUser();\n\n    if (!user) throw new Error('[checkoutActions] User not authenticated!');\n\n    ({ id: userId, subscription } = user);\n\n    if (user.subscription?.subscriptionId) {\n      await stripeClient.cancelSubscription(\n        user.subscription?.subscriptionId,\n        `[user action] \"${user.subscription?.subscriptionId}\" subscription was cancelled by user.`\n      );\n    }\n\n    return `${withoutTrailingSlash(process.env.APP_BASE_URL)}/${PrivateRoutes.checkout}`;\n  } catch (error: any) {\n    console.error(\n      `[checkoutActions] Error during cancel subscription ${subscription?.subscriptionId} for user ${userId}:`,\n      error\n    );\n\n    throw new Error('[checkoutActions] Could not create session');\n  }\n};\n\nexport const getUpdatedSubscriptionData = async (subscription: Stripe.Subscription): Promise<Subscription> => {\n  try {\n    const product = await stripeClient.getSubscriptionProduct(subscription);\n    const { name, metadata } = product;\n    const { coaches, trialDays, analytics, allowedIntegration } = metadata as any;\n    const trialUsed =\n      !process.env.STRIPE_FREE_PRICE || (subscription as any).plan?.id !== process.env.STRIPE_FREE_PRICE;\n\n    return {\n      name,\n      subscriptionId: subscription.id,\n      customerId: subscription.customer as string,\n      status: subscription.status,\n      coaches,\n      trialDays,\n      analytics,\n      allowedIntegration,\n      canceledAt: subscription.trial_end ? new Date(subscription.trial_end * 1000) : null,\n      trialUsed,\n    } as Subscription;\n  } catch (error: any) {\n    console.error(`[checkoutActions] Error during get data for  activesubscription ${subscription.id}:`, error);\n\n    throw new Error('[checkoutActions] Could not get active subscription data');\n  }\n};\n\nexport const getCancelSubscriptionData = async (eventData: any): Promise<Subscription> => {\n  try {\n    return {\n      customerId: eventData.customer,\n      status: SubscriptionStatus.canceled,\n      canceledAt: new Date(eventData.canceled_at * 1000),\n    } as Subscription;\n  } catch (error: any) {\n    console.error(`[checkoutActions] Error during get data for cancelled subscription ${eventData.id}:`, error);\n\n    throw new Error('[checkoutActions] Could not get canceled subscription data');\n  }\n};\n\nexport const updateSubscriptionData = async (\n  customerId: string,\n  subscriptionData: Subscription,\n  isDeleted: boolean = false\n) => {\n  try {\n    const subscription = isDeleted\n      ? await deleteUserSubscription(customerId)\n      : await updateUserSubscription(customerId, subscriptionData);\n\n    if (subscription?.userId) {\n      eventEmitter.emit(`message:${subscription.userId}`, {\n        user_id: subscription.userId,\n        event: 'subscriptionUpdated',\n      });\n    }\n  } catch (error: any) {\n    console.error(`[checkoutActions] Error deleting subscription data for customer ${customerId}:`, error);\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1712, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/server/actions/sessionActions.ts"],"sourcesContent":["'use server';\n\nimport 'server-only';\n\nimport { revalidatePath, revalidateTag } from 'next/cache';\nimport { isDynamicServerError } from 'next/dist/client/components/hooks-server-context';\nimport { cookies } from 'next/headers';\n\nimport { SESSION_COOKIE_NAME } from '@/lib/constants';\nimport { SessionPayload } from '@/lib/models/auth.models';\nimport { deleteCookie, getCookie } from '@/lib/utils/cookie.utils';\nimport { encrypt } from '@/lib/utils/encryption.utils';\n\nconst secretKey = process.env.SESSION_JWT_KEY;\n\nexport async function createSession(userId: string, accessAllowed: boolean, assistantId: string) {\n  try {\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000);\n    const session = (await encrypt({ userId, expiresAt, accessAllowed, assistantId }, secretKey)) || '';\n    const cookieStore = await cookies();\n\n    cookieStore.set(SESSION_COOKIE_NAME, session, {\n      httpOnly: true,\n      secure: true,\n      expires: expiresAt,\n      sameSite: 'lax',\n      path: '/',\n    });\n  } catch (error) {\n    console.error('[sessionActions] Error creating session:', error);\n\n    throw new Error('[session] Session creation error');\n  }\n}\n\nexport async function verifySession(): Promise<SessionPayload | null> {\n  try {\n    const session = await getCookie<SessionPayload>(SESSION_COOKIE_NAME, true, secretKey);\n\n    return session;\n  } catch (error) {\n    if (isDynamicServerError(error)) {\n      return null;\n    }\n    console.error('[sessionActions] Error verifying session:', error);\n\n    return null;\n  }\n}\n\nexport async function getSessionUser(): Promise<string | undefined> {\n  try {\n    const session = await verifySession();\n\n    return session?.userId;\n  } catch (error) {\n    console.error('[sessionActions] Error getting session user:', error);\n\n    return;\n  }\n}\n\nexport async function updateSession(\n  newData?: Partial<SessionPayload>,\n  tags?: string[],\n  paths?: string[]\n): Promise<void> {\n  try {\n    const payload = await verifySession();\n\n    if (!payload) return;\n\n    const cookieStore = await cookies();\n    const session = (await encrypt({ ...payload, ...newData }, secretKey)) || '';\n\n    cookieStore.set(SESSION_COOKIE_NAME, session, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax',\n      path: '/',\n    });\n\n    tags && tags.forEach(revalidateTag);\n    paths && paths.forEach((path) => revalidatePath(path));\n  } catch (error) {\n    console.error('[sessionActions] Error updating session:', error);\n  }\n}\n\nexport async function deleteSession() {\n  await deleteCookie(SESSION_COOKIE_NAME);\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AAEA;AACA;AACA;AAEA;AAEA;AACA;;;;;;;;;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,eAAe;AAEtC,eAAe,cAAc,MAAc,EAAE,aAAsB,EAAE,WAAmB;IAC7F,IAAI;QACF,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK;QACvD,MAAM,UAAU,AAAC,MAAM,CAAA,GAAA,0IAAA,CAAA,UAAO,AAAD,EAAE;YAAE;YAAQ;YAAW;YAAe;QAAY,GAAG,cAAe;QACjG,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;QAEhC,YAAY,GAAG,CAAC,uHAAA,CAAA,sBAAmB,EAAE,SAAS;YAC5C,UAAU;YACV,QAAQ;YACR,SAAS;YACT,UAAU;YACV,MAAM;QACR;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4CAA4C;QAE1D,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,UAAU,MAAM,CAAA,GAAA,sIAAA,CAAA,YAAS,AAAD,EAAkB,uHAAA,CAAA,sBAAmB,EAAE,MAAM;QAE3E,OAAO;IACT,EAAE,OAAO,OAAO;QACd,IAAI,CAAA,GAAA,kLAAA,CAAA,uBAAoB,AAAD,EAAE,QAAQ;YAC/B,OAAO;QACT;QACA,QAAQ,KAAK,CAAC,6CAA6C;QAE3D,OAAO;IACT;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,UAAU,MAAM;QAEtB,OAAO,SAAS;IAClB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gDAAgD;QAE9D;IACF;AACF;AAEO,eAAe,cACpB,OAAiC,EACjC,IAAe,EACf,KAAgB;IAEhB,IAAI;QACF,MAAM,UAAU,MAAM;QAEtB,IAAI,CAAC,SAAS;QAEd,MAAM,cAAc,MAAM,CAAA,GAAA,+HAAA,CAAA,UAAO,AAAD;QAChC,MAAM,UAAU,AAAC,MAAM,CAAA,GAAA,0IAAA,CAAA,UAAO,AAAD,EAAE;YAAE,GAAG,OAAO;YAAE,GAAG,OAAO;QAAC,GAAG,cAAe;QAE1E,YAAY,GAAG,CAAC,uHAAA,CAAA,sBAAmB,EAAE,SAAS;YAC5C,UAAU;YACV,QAAQ;YACR,UAAU;YACV,MAAM;QACR;QAEA,QAAQ,KAAK,OAAO,CAAC,6HAAA,CAAA,gBAAa;QAClC,SAAS,MAAM,OAAO,CAAC,CAAC,OAAS,CAAA,GAAA,6HAAA,CAAA,iBAAc,AAAD,EAAE;IAClD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4CAA4C;IAC5D;AACF;AAEO,eAAe;IACpB,MAAM,CAAA,GAAA,sIAAA,CAAA,eAAY,AAAD,EAAE,uHAAA,CAAA,sBAAmB;AACxC;;;IA5EsB;IAoBA;IAeA;IAYA;IA2BA;;AA1EA,+OAAA;AAoBA,+OAAA;AAeA,+OAAA;AAYA,+OAAA;AA2BA,+OAAA","debugId":null}},
    {"offset": {"line": 1825, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/server/actions/userActions.ts"],"sourcesContent":["'use server';\n\nimport { SIGNUP_MODE_COOKIE_NAME } from '@/lib/constants';\nimport { deleteFirebaseUser } from '@/lib/firebase';\nimport { User } from '@/lib/models/common.models';\nimport { isActiveSubscription } from '@/lib/utils/common.utils';\nimport { deleteCookie, getCookie } from '@/lib/utils/cookie.utils';\nimport { userAccountSchema } from '@/lib/utils/db.utils';\nimport { decrypt } from '@/lib/utils/encryption.utils';\nimport { stripeClient } from '../db/stripeClient';\nimport {\n  createUserSubscription,\n  deleteUserData,\n  getUserData,\n  updateUser,\n  updateUserSubscription,\n} from '../db/userClient';\nimport { createUserFreeSubscription, getUpdatedSubscriptionData, getUserCurrentPrice } from './checkoutActions';\nimport { deleteSession, getSessionUser, updateSession } from './sessionActions';\n\ninterface DeleteAccountParams {\n  email: string;\n  password: string;\n}\n\nexport async function getUser(): Promise<User | null> {\n  let userId;\n  try {\n    userId = await getSessionUser();\n\n    if (!userId) throw new Error('[userActions] User not authenticated!');\n\n    const user = await getUserData(userId || '');\n\n    return user as User;\n  } catch (error) {\n    console.error(`[userActions] Error fetching user ${userId}`, error);\n\n    return null;\n  }\n}\n\nexport async function updateUserAccount(name: string, email: string): Promise<any> {\n  let userId;\n  try {\n    userId = await getSessionUser();\n    const parsedData = userAccountSchema.safeParse({ name, email });\n\n    if (!parsedData.success) {\n      return { errors: parsedData.error.errors.map(({ message, path }) => ({ name: path[0], message })) };\n    }\n\n    const user = await updateUser(userId || '', { name, email });\n\n    return {\n      successMessage: 'Account.accountForm.successMessage',\n      value: { name: user?.name || '', email: user?.email || '' },\n    };\n  } catch (error) {\n    console.error(`[userActions] Error updating account data for user ${userId}`, error);\n\n    return { error: 'General.errors.unexpectedError' };\n  }\n}\n\nexport async function updateUserData(data: Pick<User, 'onboardingPassed'>): Promise<any> {\n  let userId;\n  try {\n    userId = await getSessionUser();\n\n    const user = await updateUser(userId || '', data);\n\n    return user;\n  } catch (error) {\n    console.error(`[userActions] Error updating user ${userId} data: `, error);\n\n    return { error: 'General.errors.unexpectedError' };\n  }\n}\n\nexport async function deleteUserAccount({\n  email,\n  password,\n}: DeleteAccountParams): Promise<{ success: boolean; error?: string }> {\n  let userId;\n\n  try {\n    const user = await getUser();\n\n    if (!user) {\n      throw new Error('User not authenticated');\n    }\n    userId = user.id;\n\n    await Promise.all([\n      deleteFirebaseUser(email, password),\n      stripeClient.deleteCustomer(user.subscription?.customerId),\n      deleteUserData(user.id),\n      deleteSession(),\n    ]);\n\n    return { success: true };\n  } catch (error) {\n    console.error(`[userActions] Error deleting user account ${userId}:`, error);\n\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : 'Failed to delete account',\n    };\n  }\n}\n\nexport async function checkSignupModeParam(user: User): Promise<boolean> {\n  const encryptedMode = await getCookie<string>(SIGNUP_MODE_COOKIE_NAME);\n  const isAllowedParam = !!encryptedMode && process.env.ALLOWED_SIGNUP_MODE_VALUES?.split(',').includes(encryptedMode);\n\n  if (!isAllowedParam) return false;\n\n  const modeData = await decrypt<{ trialDays: number }>(encryptedMode, process.env.ENCODE_SECRET_KEY);\n  const freeTrialSub = await createUserFreeSubscription(user, modeData?.trialDays || 14);\n  await deleteCookie(SIGNUP_MODE_COOKIE_NAME);\n\n  return !!freeTrialSub;\n}\n\nexport async function checkExistingSubscription({ subscription, id, email }: User): Promise<boolean | null> {\n  const currentPrice = await getUserCurrentPrice({ subscription } as User);\n\n  if (!!subscription && isActiveSubscription(subscription, currentPrice?.id)) return true;\n\n  const stripeSubscription = await stripeClient.getStripeActiveSubscriptionByEmail(email || '');\n\n  if (!stripeSubscription || !id) return null;\n\n  const subscriptionData = await getUpdatedSubscriptionData(stripeSubscription);\n  const updatedSubscription = subscription?.customerId\n    ? await updateUserSubscription(subscription.customerId, subscriptionData)\n    : await createUserSubscription(id, subscriptionData);\n\n  return isActiveSubscription(updatedSubscription, (stripeSubscription as any).plan.id);\n}\n\nexport async function checkUserSubscription(user: User): Promise<boolean> {\n  try {\n    const hasExistingSubscription = await checkExistingSubscription(user);\n\n    if (hasExistingSubscription !== null) {\n      await deleteCookie(SIGNUP_MODE_COOKIE_NAME);\n      return hasExistingSubscription;\n    }\n\n    return checkSignupModeParam(user);\n  } catch (error: any) {\n    console.error(`[userActions] Error checking user ${user.id} subscription:`, error);\n\n    return false;\n  }\n}\n\nexport async function checkUserAccessAllowed(currentUser?: User | null): Promise<boolean> {\n  try {\n    const user = currentUser || (await getUser());\n\n    if (!user) return false;\n\n    const accessAllowed = user.accessAllowed || (await checkUserSubscription(user));\n\n    await updateSession({ accessAllowed });\n\n    return accessAllowed;\n  } catch (error: any) {\n    console.error(`[userActions] Error checking user ${currentUser?.id} access allowed:`, error);\n\n    return false;\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2016, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/shared/Analytics.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Analytics = registerClientReference(\n    function() { throw new Error(\"Attempted to call Analytics() from the server but Analytics is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/shared/Analytics.tsx <module evaluation>\",\n    \"Analytics\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,0DACA","debugId":null}},
    {"offset": {"line": 2030, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/shared/Analytics.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const Analytics = registerClientReference(\n    function() { throw new Error(\"Attempted to call Analytics() from the server but Analytics is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/shared/Analytics.tsx\",\n    \"Analytics\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,YAAY,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAkO,GAC/P,sCACA","debugId":null}},
    {"offset": {"line": 2044, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 2053, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/cbi_2cb9f026.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"cbi_2cb9f026-module__1EVGDW__className\",\n  \"variable\": \"cbi_2cb9f026-module__1EVGDW__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 2063, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/styles/cbi_2cb9f026.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/local/cssmodule.module.css?{%22path%22:%22fonts.ts%22,%22import%22:%22%22,%22arguments%22:[{%22src%22:[{%22path%22:%22../../public/IconFont/coachbot-icons.woff%22},{%22path%22:%22../../public/IconFont/coachbot-icons.ttf%22}],%22weight%22:%22normal%22,%22style%22:%22normal%22,%22variable%22:%22--font-cbi%22}],%22variableName%22:%22cbi%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'cbi', 'cbi Fallback'\",\n        \n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,yIAAA,CAAA,UAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;IAEhB;AACJ;AAEA,IAAI,yIAAA,CAAA,UAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,yIAAA,CAAA,UAAS,CAAC,QAAQ;AAC1C;uCAEe","debugId":null}},
    {"offset": {"line": 2083, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/helveticanow_c21601ec.module.css [app-rsc] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"className\": \"helveticanow_c21601ec-module__UrvVba__className\",\n  \"variable\": \"helveticanow_c21601ec-module__UrvVba__variable\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA"}},
    {"offset": {"line": 2093, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/styles/helveticanow_c21601ec.js"],"sourcesContent":["import cssModule from \"@vercel/turbopack-next/internal/font/local/cssmodule.module.css?{%22path%22:%22fonts.ts%22,%22import%22:%22%22,%22arguments%22:[{%22src%22:[{%22path%22:%22../../public/HelveticaNow/HelveticaNowDisplay.woff2%22},{%22path%22:%22../../public/HelveticaNow/HelveticaNowDisplay.woff%22}],%22style%22:%22normal%22,%22display%22:%22swap%22,%22variable%22:%22--font-helvetica-now%22}],%22variableName%22:%22helveticaNow%22}\";\nconst fontData = {\n    className: cssModule.className,\n    style: {\n        fontFamily: \"'helveticaNow', 'helveticaNow Fallback'\",\n        \n    },\n};\n\nif (cssModule.variable != null) {\n    fontData.variable = cssModule.variable;\n}\n\nexport default fontData;\n"],"names":[],"mappings":";;;AAAA;;AACA,MAAM,WAAW;IACb,WAAW,kJAAA,CAAA,UAAS,CAAC,SAAS;IAC9B,OAAO;QACH,YAAY;IAEhB;AACJ;AAEA,IAAI,kJAAA,CAAA,UAAS,CAAC,QAAQ,IAAI,MAAM;IAC5B,SAAS,QAAQ,GAAG,kJAAA,CAAA,UAAS,CAAC,QAAQ;AAC1C;uCAEe","debugId":null}},
    {"offset": {"line": 2114, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 2157, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/app/layout.tsx"],"sourcesContent":["import type { Metadata } from 'next';\n\nimport '@/styles/globals.css';\n\nimport { ReactNode } from 'react';\nimport dynamic from 'next/dynamic';\nimport { NextIntlClientProvider } from 'next-intl';\nimport { getLocale, getMessages } from 'next-intl/server';\n\nimport { AccessProvider } from '@/contexts/AccessProvider';\nimport { ThemeProvider } from '@/contexts/ThemeContext';\nimport { getUser } from '@/server/actions/userActions';\nimport { Analytics } from '@/shared/Analytics';\nimport { cbi, helveticaNow } from '@/styles/fonts';\n\nconst GradientBackground = dynamic(() => import('@/shared/Background').then((mod) => mod.GradientBackground));\n\nexport const metadata: Metadata = {\n  title: 'CoachBot Studio',\n  description: 'Your 24/7 Growth Partner.',\n};\n\nexport default async function RootLayout({ children, modal }: Readonly<{ children: ReactNode; modal: ReactNode }>) {\n  const [locale, messages] = await Promise.all([getLocale(), getMessages()]);\n\n  return (\n    <html lang={locale} className={'size-full scroll-smooth bg-violet-950 antialiased'}>\n      <head>\n        <meta charSet=\"UTF-8\" />\n        <meta httpEquiv=\"X-UA-Compatible\" content=\"IE=edge\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" />\n        <link rel=\"icon\" href=\"/favicon.ico\" />\n        <link rel=\"apple-touch-icon\" href=\"/favicon.ico\"></link>\n      </head>\n      <body className={`${helveticaNow.className} ${cbi.className} antialiased`}>\n        <Analytics envUrl={process.env.APP_BASE_URL} user$={getUser()} />\n        <NextIntlClientProvider messages={messages}>\n          <AccessProvider>\n            <ThemeProvider>\n              {children}\n              {modal}\n            </ThemeProvider>\n          </AccessProvider>\n        </NextIntlClientProvider>\n        <GradientBackground />\n      </body>\n    </html>\n  );\n}\n"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;AAAA;AAEA;AACA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;;;;;AAEA,MAAM,qBAAqB,CAAA,GAAA,+JAAA,CAAA,UAAO,AAAD,EAAE,IAAM,iJAA8B,IAAI,CAAC,CAAC,MAAQ,IAAI,kBAAkB;;;;;;;AAEpG,MAAM,WAAqB;IAChC,OAAO;IACP,aAAa;AACf;AAEe,eAAe,WAAW,EAAE,QAAQ,EAAE,KAAK,EAAuD;IAC/G,MAAM,CAAC,QAAQ,SAAS,GAAG,MAAM,QAAQ,GAAG,CAAC;QAAC,CAAA,GAAA,4OAAA,CAAA,YAAS,AAAD;QAAK,CAAA,GAAA,gPAAA,CAAA,cAAW,AAAD;KAAI;IAEzE,qBACE,8OAAC;QAAK,MAAM;QAAQ,WAAW;;0BAC7B,8OAAC;;kCACC,8OAAC;wBAAK,SAAQ;;;;;;kCACd,8OAAC;wBAAK,WAAU;wBAAkB,SAAQ;;;;;;kCAC1C,8OAAC;wBAAK,MAAK;wBAAW,SAAQ;;;;;;kCAC9B,8OAAC;wBAAK,KAAI;wBAAO,MAAK;;;;;;kCACtB,8OAAC;wBAAK,KAAI;wBAAmB,MAAK;;;;;;;;;;;;0BAEpC,8OAAC;gBAAK,WAAW,GAAG,iLAAA,CAAA,eAAY,CAAC,SAAS,CAAC,CAAC,EAAE,+JAAA,CAAA,MAAG,CAAC,SAAS,CAAC,YAAY,CAAC;;kCACvE,8OAAC,2HAAA,CAAA,YAAS;wBAAC,QAAQ,QAAQ,GAAG,CAAC,YAAY;wBAAE,OAAO,CAAA,GAAA,uIAAA,CAAA,UAAO,AAAD;;;;;;kCAC1D,8OAAC,kQAAA,CAAA,yBAAsB;wBAAC,UAAU;kCAChC,cAAA,8OAAC,kIAAA,CAAA,iBAAc;sCACb,cAAA,8OAAC,gIAAA,CAAA,gBAAa;;oCACX;oCACA;;;;;;;;;;;;;;;;;kCAIP,8OAAC;;;;;;;;;;;;;;;;;AAIT","debugId":null}}]
}