{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 60, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/eventEmitter.ts"],"sourcesContent":["import { EventEmitter } from 'events';\n\ndeclare global {\n  // eslint-disable-next-line no-var\n  var _eventEmitter: EventEmitter | undefined;\n}\n\nconst eventEmitter = global._eventEmitter || new EventEmitter();\nglobal._eventEmitter = eventEmitter;\n\nexport default eventEmitter;\n"],"names":[],"mappings":";;;AAAA;;AAOA,MAAM,eAAe,OAAO,aAAa,IAAI,IAAI,qGAAA,CAAA,eAAY;AAC7D,OAAO,aAAa,GAAG;uCAER","debugId":null}},
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/constants.ts"],"sourcesContent":["import { Locale } from './models/locale.models';\n\nexport const LOCALE_COOKIE_NAME = 'NEXT_LOCALE';\nexport const SIGNUP_MODE_COOKIE_NAME = 'mode';\nexport const DEFAULT_LOCALE: Locale = 'en';\n\nexport const HOME_ROUTE = '/chat';\nexport const LOGIN_ROUTE = '/login';\n\nexport const SESSION_COOKIE_NAME = 'cbs_ses';\n\nexport const MIN_CATEGORIES_COUNT = 3;\nexport const MAX_CATEGORIES_COUNT = 10;\n\nexport const ACCEPTED_FILE_TYPES = {\n  'application/pdf': ['.pdf'],\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document': ['.docx', '.dotx', '.docm', '.dotm'],\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.template': ['.docx', '.dotx', '.docm', '.dotm'],\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet': ['.xlsx', '.xls'],\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation': [\n    '.pptx',\n    '.potx',\n    '.ppsx',\n    '.pptm',\n    '.potm',\n    '.ppsm',\n  ],\n  'application/json': ['.json'],\n  'application/xml': ['.xml'],\n  'text/markdown': ['.md'],\n  'text/x-markdown': ['.md'],\n  'text/plain': ['.txt'],\n  'text/x-asciidoc': ['.adoc'],\n  'text/html': ['.html', '.xhtml'],\n  'text/csv': ['.csv'],\n  'image/png': ['.png'],\n  'image/jpeg': ['.jpg', '.jpeg'],\n  'image/tiff': ['.tiff'],\n  'image/bmp': ['.bmp'],\n};\n\nexport enum PublicRoutes {\n  login = '/login',\n  signup = '/signup',\n  forgotPassword = '/forgot-password',\n  verification = '/verification',\n}\n\nexport enum PrivateRoutes {\n  chat = '/chat',\n  dashboard = '/dashboard',\n  checkout = '/checkout',\n  feedback = '/account/feedback',\n  stageInstructions = '/instructions/stages',\n  moderationInstructions = '/instructions/moderation',\n  instructions = '/instructions',\n  account = '/account',\n  content = '/content',\n  configuration = '/configuration',\n  coach = '/coach',\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEO,MAAM,qBAAqB;AAC3B,MAAM,0BAA0B;AAChC,MAAM,iBAAyB;AAE/B,MAAM,aAAa;AACnB,MAAM,cAAc;AAEpB,MAAM,sBAAsB;AAE5B,MAAM,uBAAuB;AAC7B,MAAM,uBAAuB;AAE7B,MAAM,sBAAsB;IACjC,mBAAmB;QAAC;KAAO;IAC3B,2EAA2E;QAAC;QAAS;QAAS;QAAS;KAAQ;IAC/G,2EAA2E;QAAC;QAAS;QAAS;QAAS;KAAQ;IAC/G,qEAAqE;QAAC;QAAS;KAAO;IACtF,6EAA6E;QAC3E;QACA;QACA;QACA;QACA;QACA;KACD;IACD,oBAAoB;QAAC;KAAQ;IAC7B,mBAAmB;QAAC;KAAO;IAC3B,iBAAiB;QAAC;KAAM;IACxB,mBAAmB;QAAC;KAAM;IAC1B,cAAc;QAAC;KAAO;IACtB,mBAAmB;QAAC;KAAQ;IAC5B,aAAa;QAAC;QAAS;KAAS;IAChC,YAAY;QAAC;KAAO;IACpB,aAAa;QAAC;KAAO;IACrB,cAAc;QAAC;QAAQ;KAAQ;IAC/B,cAAc;QAAC;KAAQ;IACvB,aAAa;QAAC;KAAO;AACvB;AAEO,IAAA,AAAK,sCAAA;;;;;WAAA;;AAOL,IAAA,AAAK,uCAAA;;;;;;;;;;;;WAAA","debugId":null}},
    {"offset": {"line": 197, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/encryption.utils.ts"],"sourcesContent":["import { JWTPayload, jwtVerify, SignJWT } from 'jose';\n\nimport 'server-only';\n\nexport async function encrypt<T extends JWTPayload>(\n  payload: T,\n  secretKey?: string,\n  expirationTime: string = '7d'\n): Promise<string | null> {\n  if (!payload || !secretKey) return null;\n\n  const encodedKey = new TextEncoder().encode(secretKey);\n\n  return new SignJWT(payload)\n    .setProtectedHeader({ alg: 'HS256' })\n    .setIssuedAt()\n    .setExpirationTime(expirationTime)\n    .sign(encodedKey);\n}\n\nexport async function decrypt<T>(encryptedData: string | undefined = '', secretKey?: string): Promise<T | null> {\n  try {\n    if (!encryptedData || !secretKey) return null;\n\n    const encodedKey = new TextEncoder().encode(secretKey);\n    const { payload } = await jwtVerify(encryptedData, encodedKey, { algorithms: ['HS256'] });\n\n    return payload as T;\n  } catch (error: any) {\n    console.error('[encryptionUtils] Failed to decrypt data:', error);\n    return null;\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AAEA;;;AAEO,eAAe,QACpB,OAAU,EACV,SAAkB,EAClB,iBAAyB,IAAI;IAE7B,IAAI,CAAC,WAAW,CAAC,WAAW,OAAO;IAEnC,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC;IAE5C,OAAO,IAAI,uJAAA,CAAA,UAAO,CAAC,SAChB,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,WAAW,GACX,iBAAiB,CAAC,gBAClB,IAAI,CAAC;AACV;AAEO,eAAe,QAAW,gBAAoC,EAAE,EAAE,SAAkB;IACzF,IAAI;QACF,IAAI,CAAC,iBAAiB,CAAC,WAAW,OAAO;QAEzC,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC;QAC5C,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,CAAA,GAAA,yJAAA,CAAA,YAAS,AAAD,EAAE,eAAe,YAAY;YAAE,YAAY;gBAAC;aAAQ;QAAC;QAEvF,OAAO;IACT,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,6CAA6C;QAC3D,OAAO;IACT;AACF","debugId":null}},
    {"offset": {"line": 234, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/lib/utils/cookie.utils.ts"],"sourcesContent":["import { cookies } from 'next/headers';\n\nimport { decrypt } from './encryption.utils';\n\nexport const getCookie = async <T>(name: string, encrypted?: boolean, secretKey?: string): Promise<T> => {\n  const cookieStore = await cookies();\n  const value = cookieStore.get(name)?.value;\n\n  return (value && encrypted ? decrypt<T>(value, secretKey) : value) as T;\n};\n\nexport const deleteCookie = async (name: string) => {\n  const cookieStore = await cookies();\n  cookieStore.delete(name);\n};\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;AAEO,MAAM,YAAY,OAAU,MAAc,WAAqB;IACpE,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAChC,MAAM,QAAQ,YAAY,GAAG,CAAC,OAAO;IAErC,OAAQ,SAAS,YAAY,CAAA,GAAA,4IAAA,CAAA,UAAO,AAAD,EAAK,OAAO,aAAa;AAC9D;AAEO,MAAM,eAAe,OAAO;IACjC,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;IAChC,YAAY,MAAM,CAAC;AACrB","debugId":null}},
    {"offset": {"line": 257, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/server/actions/sessionActions.ts"],"sourcesContent":["'use server';\n\nimport 'server-only';\n\nimport { revalidatePath, revalidateTag } from 'next/cache';\nimport { isDynamicServerError } from 'next/dist/client/components/hooks-server-context';\nimport { cookies } from 'next/headers';\n\nimport { SESSION_COOKIE_NAME } from '@/lib/constants';\nimport { SessionPayload } from '@/lib/models/auth.models';\nimport { deleteCookie, getCookie } from '@/lib/utils/cookie.utils';\nimport { encrypt } from '@/lib/utils/encryption.utils';\n\nconst secretKey = process.env.SESSION_JWT_KEY;\n\nexport async function createSession(userId: string, accessAllowed: boolean, assistantId: string) {\n  try {\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000);\n    const session = (await encrypt({ userId, expiresAt, accessAllowed, assistantId }, secretKey)) || '';\n    const cookieStore = await cookies();\n\n    cookieStore.set(SESSION_COOKIE_NAME, session, {\n      httpOnly: true,\n      secure: true,\n      expires: expiresAt,\n      sameSite: 'lax',\n      path: '/',\n    });\n  } catch (error) {\n    console.error('[sessionActions] Error creating session:', error);\n\n    throw new Error('[session] Session creation error');\n  }\n}\n\nexport async function verifySession(): Promise<SessionPayload | null> {\n  try {\n    const session = await getCookie<SessionPayload>(SESSION_COOKIE_NAME, true, secretKey);\n\n    return session;\n  } catch (error) {\n    if (isDynamicServerError(error)) {\n      return null;\n    }\n    console.error('[sessionActions] Error verifying session:', error);\n\n    return null;\n  }\n}\n\nexport async function getSessionUser(): Promise<string | undefined> {\n  try {\n    const session = await verifySession();\n\n    return session?.userId;\n  } catch (error) {\n    console.error('[sessionActions] Error getting session user:', error);\n\n    return;\n  }\n}\n\nexport async function updateSession(\n  newData?: Partial<SessionPayload>,\n  tags?: string[],\n  paths?: string[]\n): Promise<void> {\n  try {\n    const payload = await verifySession();\n\n    if (!payload) return;\n\n    const cookieStore = await cookies();\n    const session = (await encrypt({ ...payload, ...newData }, secretKey)) || '';\n\n    cookieStore.set(SESSION_COOKIE_NAME, session, {\n      httpOnly: true,\n      secure: true,\n      sameSite: 'lax',\n      path: '/',\n    });\n\n    tags && tags.forEach(revalidateTag);\n    paths && paths.forEach((path) => revalidatePath(path));\n  } catch (error) {\n    console.error('[sessionActions] Error updating session:', error);\n  }\n}\n\nexport async function deleteSession() {\n  await deleteCookie(SESSION_COOKIE_NAME);\n}\n"],"names":[],"mappings":";;;;;;;;;AAEA;AAEA;AACA;AACA;AAEA;AAEA;AACA;;;;;;;;;;;AAEA,MAAM,YAAY,QAAQ,GAAG,CAAC,eAAe;AAEtC,eAAe,cAAc,MAAc,EAAE,aAAsB,EAAE,WAAmB;IAC7F,IAAI;QACF,MAAM,YAAY,IAAI,KAAK,KAAK,GAAG,KAAK,KAAK,KAAK,KAAK;QACvD,MAAM,UAAU,AAAC,MAAM,CAAA,GAAA,4IAAA,CAAA,UAAO,AAAD,EAAE;YAAE;YAAQ;YAAW;YAAe;QAAY,GAAG,cAAe;QACjG,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QAEhC,YAAY,GAAG,CAAC,yHAAA,CAAA,sBAAmB,EAAE,SAAS;YAC5C,UAAU;YACV,QAAQ;YACR,SAAS;YACT,UAAU;YACV,MAAM;QACR;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4CAA4C;QAE1D,MAAM,IAAI,MAAM;IAClB;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,UAAU,MAAM,CAAA,GAAA,wIAAA,CAAA,YAAS,AAAD,EAAkB,yHAAA,CAAA,sBAAmB,EAAE,MAAM;QAE3E,OAAO;IACT,EAAE,OAAO,OAAO;QACd,IAAI,CAAA,GAAA,oLAAA,CAAA,uBAAoB,AAAD,EAAE,QAAQ;YAC/B,OAAO;QACT;QACA,QAAQ,KAAK,CAAC,6CAA6C;QAE3D,OAAO;IACT;AACF;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,UAAU,MAAM;QAEtB,OAAO,SAAS;IAClB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,gDAAgD;QAE9D;IACF;AACF;AAEO,eAAe,cACpB,OAAiC,EACjC,IAAe,EACf,KAAgB;IAEhB,IAAI;QACF,MAAM,UAAU,MAAM;QAEtB,IAAI,CAAC,SAAS;QAEd,MAAM,cAAc,MAAM,CAAA,GAAA,iIAAA,CAAA,UAAO,AAAD;QAChC,MAAM,UAAU,AAAC,MAAM,CAAA,GAAA,4IAAA,CAAA,UAAO,AAAD,EAAE;YAAE,GAAG,OAAO;YAAE,GAAG,OAAO;QAAC,GAAG,cAAe;QAE1E,YAAY,GAAG,CAAC,yHAAA,CAAA,sBAAmB,EAAE,SAAS;YAC5C,UAAU;YACV,QAAQ;YACR,UAAU;YACV,MAAM;QACR;QAEA,QAAQ,KAAK,OAAO,CAAC,+HAAA,CAAA,gBAAa;QAClC,SAAS,MAAM,OAAO,CAAC,CAAC,OAAS,CAAA,GAAA,+HAAA,CAAA,iBAAc,AAAD,EAAE;IAClD,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4CAA4C;IAC5D;AACF;AAEO,eAAe;IACpB,MAAM,CAAA,GAAA,wIAAA,CAAA,eAAY,AAAD,EAAE,yHAAA,CAAA,sBAAmB;AACxC;;;IA5EsB;IAoBA;IAeA;IAYA;IA2BA;;AA1EA,iPAAA;AAoBA,iPAAA;AAeA,iPAAA;AAYA,iPAAA;AA2BA,iPAAA","debugId":null}},
    {"offset": {"line": 370, "column": 0}, "map": {"version":3,"sources":["file:///Users/stefangajanovic/Desktop/coachbot/coachbot-codex/src/app/api/sse/route.ts"],"sourcesContent":["import { NextRequest } from 'next/server';\n\nimport eventEmitter from '@/lib/eventEmitter';\nimport { getSessionUser } from '@/server/actions/sessionActions';\n\nexport async function GET(req: NextRequest) {\n  const userId = await getSessionUser();\n\n  if (!userId) {\n    return new Response('Unauthorized', { status: 401 });\n  }\n\n  const stream = new ReadableStream({\n    start(controller) {\n      const encoder = new TextEncoder();\n      const intervalId = setInterval(() => {\n        controller.enqueue(encoder.encode(': keep-alive\\n\\n'));\n      }, 30000);\n\n      const sendEvent = ({ user_id, event, data }: { user_id: string; event: string; data: string }) => {\n        if (user_id === userId) {\n          controller.enqueue(encoder.encode(`event: ${event}\\ndata: ${JSON.stringify(data)}\\n\\n`));\n        }\n      };\n\n      eventEmitter.on(`message:${userId}`, sendEvent);\n\n      req.signal.addEventListener('abort', () => {\n        eventEmitter.off(`message:${userId}`, sendEvent);\n        controller.close();\n        clearInterval(intervalId);\n      });\n    },\n  });\n\n  return new Response(stream, {\n    headers: {\n      'Content-Type': 'text/event-stream',\n      'Cache-Control': 'no-cache',\n      Connection: 'keep-alive',\n      // 'Access-Control-Allow-Origin': '*',\n    },\n  });\n}\n"],"names":[],"mappings":";;;AAEA;AACA;;;AAEO,eAAe,IAAI,GAAgB;IACxC,MAAM,SAAS,MAAM,CAAA,GAAA,4IAAA,CAAA,iBAAc,AAAD;IAElC,IAAI,CAAC,QAAQ;QACX,OAAO,IAAI,SAAS,gBAAgB;YAAE,QAAQ;QAAI;IACpD;IAEA,MAAM,SAAS,IAAI,eAAe;QAChC,OAAM,UAAU;YACd,MAAM,UAAU,IAAI;YACpB,MAAM,aAAa,YAAY;gBAC7B,WAAW,OAAO,CAAC,QAAQ,MAAM,CAAC;YACpC,GAAG;YAEH,MAAM,YAAY,CAAC,EAAE,OAAO,EAAE,KAAK,EAAE,IAAI,EAAoD;gBAC3F,IAAI,YAAY,QAAQ;oBACtB,WAAW,OAAO,CAAC,QAAQ,MAAM,CAAC,CAAC,OAAO,EAAE,MAAM,QAAQ,EAAE,KAAK,SAAS,CAAC,MAAM,IAAI,CAAC;gBACxF;YACF;YAEA,4HAAA,CAAA,UAAY,CAAC,EAAE,CAAC,CAAC,QAAQ,EAAE,QAAQ,EAAE;YAErC,IAAI,MAAM,CAAC,gBAAgB,CAAC,SAAS;gBACnC,4HAAA,CAAA,UAAY,CAAC,GAAG,CAAC,CAAC,QAAQ,EAAE,QAAQ,EAAE;gBACtC,WAAW,KAAK;gBAChB,cAAc;YAChB;QACF;IACF;IAEA,OAAO,IAAI,SAAS,QAAQ;QAC1B,SAAS;YACP,gBAAgB;YAChB,iBAAiB;YACjB,YAAY;QAEd;IACF;AACF","debugId":null}}]
}